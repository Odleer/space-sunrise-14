- type: latheRecipePack
  id: OdleerRecipe
  recipes:
  - OdleerSheetSteelRecipe


- type: latheRecipe
  abstract: true
  id: OdleerBaseXenoborgRecipe
  categories:
  - Robotics
  completetime: 10

- type: latheRecipe
  parent: OdleerBaseXenoborgRecipe
  id: OdleerSheetSteelRecipe
  result: SheetPlasteel
  materials:
    Steel: 1000

- type: entity
  parent:
  - BaseMachinePowered
  - BaseMob
  - StripableInventoryBase
  id: OdleerMothershipCore
  name: mothership core
  description: A sentient machine that can produce Xenoborgs. Without this the Xenoborgs are doomed.
  components:
  - type: Appearance
  - type: WiresVisuals
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "-0.4,-0.4,0.4,0.4"
        density: 190
        mask:
        - MachineMask
        layer:
          - MachineLayer
  - type: Sprite
    sprite: Structures/Machines/autolathe.rsi
    snapCardinals: true
    layers:
    - state: icon
      map: ["enum.LatheVisualLayers.IsRunning"]
    - state: unlit
      shader: unshaded
      map: ["enum.PowerDeviceVisualLayers.Powered"]
    - state: inserting
      map: ["enum.MaterialStorageVisualLayers.Inserting"]
    - state: panel
      map: ["enum.WiresVisualLayers.MaintenancePanel"]
  - type: Machine
    board: null
  - type: Lathe
    idleState: core-idle
    runningState: core-active
    staticPacks:
    - OdleerRecipe
  - type: MaterialStorage
    whitelist:
      tags:
      - Sheet
      - RawMaterial
      - Ingot
  - type: PointLight
    color: "#0033ff"
    enabled: true
    radius: 4
    netsync: false
  - type: Anchorable
    flags:
    - Anchorable
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 200
      behaviors:
      - !type:DoActsBehavior
        acts: ["Destruction"]
      - !type:PlaySoundBehavior
        sound:
          collection: MetalGlassBreak
      - !type:ExplodeBehavior
      - !type:SpawnEntitiesBehavior
        spawn:
          MachineFrameDestroyed:
            min: 1
            max: 1
      - !type:SpawnGasBehavior
        gasMixture:
          volume: 1000
          moles:
            - 0 # oxygen
            - 0 # nitrogen
            - 340.5701689 # carbon dioxide
          temperature: 373.15
  - type: Repairable
    doAfterDelay: 30 # you can heal the mothership core, but it takes a while
  - type: DamagedSiliconAccent
    enableChargeCorruption: false
  - type: Explosive
    explosionType: Default
    maxIntensity: 100
    intensitySlope: 2
    totalIntensity: 200
  - type: WiresPanel
  - type: ActivatableUI
    key: enum.LatheUiKey.Key
  - type: ActivatableUIRequiresPower
  - type: UserInterface
    interfaces:
      enum.SiliconLawsUiKey.Key:
        type: SiliconLawBoundUserInterface
        requireInputValidation: false
      enum.StrippingUiKey.Key:
        type: StrippableBoundUserInterface
      enum.PowerMonitoringConsoleUiKey.Key:
        type: PowerMonitoringConsoleBoundUserInterface
      enum.RadarConsoleUiKey.Key:
        type: RadarConsoleBoundUserInterface
      enum.LatheUiKey.Key:
        type: LatheBoundUserInterface
      enum.ResearchClientUiKey.Key:
        type: ResearchClientBoundUserInterface
  - type: Transform
    anchored: true
  - type: Pullable
  - type: StaticPrice
    price: 800
  - type: WarpPoint
    location: mothership core
    follow: true
  - type: VoiceOverride
    nameOverride: MOTHERSHIP CORE
  - type: IntrinsicRadioReceiver
  - type: IntrinsicRadioTransmitter
    channels:
    - Mothership
    - Xenoborg
    - Binary
  - type: ActiveRadio
    channels:
    - Mothership
    - Xenoborg
    - Binary
  - type: Tag
    tags:
    - SiliconEmotes
    - CanPilot
    - Structure
  - type: IgnoreUIRange
  - type: ComplexInteraction
  - type: MindContainer
  - type: Actions
  - type: SiliconLawProvider
    laws: MothershipCoreLawset # custom laws here
    subverted: true
  - type: Stripping
  - type: Factory
    recipe: OdleerSheetSteelRecipe
    borgRecipePack: OdleerRecipe
    enabled: true
    soundCooldown: 0.8
  - type: CollideFactory
  - type: Conveyor
  - type: IntrinsicUI
    uis:
      enum.PowerMonitoringConsoleUiKey.Key:
        toggleAction: ActionMothershipShowPower
      enum.RadarConsoleUiKey.Key:
        toggleAction: ActionMothershipShowRadar
  - type: ShowElectrocutionHUD
  - type: PowerMonitoringConsole
  - type: PowerMonitoringCableNetworks
  - type: RadarConsole

# TODO: add xenoborg control interface action (part 5)
# TODO: add xenoborg camera monitor interface action (part 5)

- type: entity
  id: ActionMothershipShowPower
  name: Power Monitoring Interface
  description: View the Power Monitoring Interface.
  components:
  - type: Action
    icon:
      sprite: Structures/Machines/computers.rsi # TODO: custom sprite here (part 5)
      state: power_monitor
    keywords: [ "AI", "console", "interface" ]
    priority: -6
  - type: InstantAction
    event: !type:ToggleIntrinsicUIEvent { key: enum.PowerMonitoringConsoleUiKey.Key }

- type: entity
  id: ActionMothershipShowRadar
  name: Radar Monitor
  description: View the radar monitor.
  components:
  - type: Action
    icon:
      sprite: Structures/Machines/computers.rsi # TODO: custom sprite here (part 5)
      state: solar_screen
    keywords: [ "AI", "console", "interface" ]
    priority: -6
  - type: InstantAction
    event: !type:ToggleIntrinsicUIEvent { key: enum.RadarConsoleUiKey.Key }